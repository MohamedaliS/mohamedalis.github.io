---
title: "Logistic Regression Basics: Predicting Purchase from Session Count"
description: "Model purchase probability as a function of on-site sessions using logistic regression, with odds ratios, confidence intervals, and interpretation guidance for binary outcomes."
date: 2025-10-25
lang: en
filters: [webr]
categories: [statistics, logistic regression, conversion optimization, ecommerce]
keywords: [logistic regression, odds ratio, purchase prediction, conversion, session behavior]
toc: true
number-sections: false
bibliography: ../../assets/refs/references.bib
citation: true
link-citations: true
canonical-url: "https://flairmi.com/blog/posts/06-logistic-basics.html"
format:
  html:
    code-fold: false
    code-tools: false
---

```{=html}
<style>
.flair-table-wrap{overflow-x:auto;margin:.75rem 0}
.flair-table{border-collapse:collapse;width:100%;font-size:.95rem;table-layout:fixed;word-wrap:break-word;}
.flair-table th,.flair-table td{border:1px solid #e1e4e8;padding:8px;vertical-align:top;word-break:break-word;}
.flair-table th{background:#f7f7f7;text-align:left}
.flair-table tr:nth-child(even){background:#fafafa}
.flair-caption{font-weight:600;margin:.25rem 0 .5rem 0}
pre,code,pre code{white-space:pre-wrap;word-break:break-word;}
@media (max-width:600px){
  .flair-table td,.flair-table th{padding:6px;font-size:.9rem}
}
.copy-row{display:flex;gap:.5rem;margin:.5rem 0;}
.copy-btn{border:1px solid #e1e4e8;background:#f7f7f7;padding:.35rem .6rem;border-radius:6px;cursor:pointer;}
.copy-btn:active{transform:scale(.98);}
</style>
```

{{< include _helpers.qmd >}}

TL;DR: Purchase probability rises from **~9% (1 session)** to **~45% (8+ sessions)** (n=1,500); **OR per session = 1.28 [1.18, 1.40]**; **McFadden R²=0.11**, **AIC=423**; decision: **each extra session increases odds by 28%, engage users across multiple visits**.

> Answer  
> Method: Logistic regression for binary outcome.  
> Estimate: OR = 1.28 per session and CI 1.18, 1.40.  
> Data: User behavior, variables sessions, purchased, n = 1,500.  
> Action: Each extra session increases purchase odds by 28%; encourage repeat visits.

## Case

You are analyzing customer behavior for an e-commerce platform and want to understand: Does the number of on-site sessions influence the likelihood of making a purchase? Specifically, how much do purchase odds increase with each additional session? Can you predict purchase probability from session count to identify high-intent customers?

## Dataset

Synthetic sample from customer session data (Schema B).

| Variable    | Label                    | Value        |
|-------------|--------------------------|--------------|
| `sessions`  | Number of sessions       | Count (0+)   |
| `purchase`  | Purchase made            | 0 (No), 1 (Yes)|
| `n`         | Number of customers      | 1,500        |
| Distribution| Mean sessions            | ≈3 (Poisson λ=3)|

## Method

We use logistic regression to model the relationship between session count (predictor) and purchase outcome (binary response). Unlike linear regression, logistic regression models the **log-odds** (logit) of the outcome:

$$
\log\left(\frac{p}{1-p}\right) = \beta_0 + \beta_1 \times \text{Sessions},
$$

where $p$ is the probability of purchase. Rearranging gives the predicted probability:

$$
p = \frac{1}{1 + e^{-(\beta_0 + \beta_1 \times \text{Sessions})}}.
$$

The **odds ratio (OR)** for a one-unit increase in sessions is:
$$
\text{OR} = e^{\beta_1}.
$$

An OR > 1 indicates increased odds of purchase with more sessions; OR < 1 indicates decreased odds. We report 95% Wald confidence intervals for the odds ratio.

**Interpretation guide**:
- OR = 1.00: No effect
- OR = 1.28: 28% increase in odds per additional session
- OR = 2.00: 100% increase (doubling) in odds
- OR = 0.80: 20% decrease in odds

## Calculation

```{webr-r}
#| label: logistic-calculation
#| code-summary: "Click to expand calculation code"

# Generate synthetic data
set.seed(5)
n <- 1500
sessions <- rpois(n, lambda = 3)
# True model: log-odds = -2 + 0.25*sessions
eta <- -2 + 0.25*sessions
p <- 1/(1+exp(-eta))
purchase <- rbinom(n, 1, p)

# Fit logistic regression
fit <- glm(purchase ~ sessions, family = binomial())

# Extract coefficients
coef_summary <- summary(fit)$coefficients
intercept <- coef_summary[1, "Estimate"]
slope <- coef_summary[2, "Estimate"]
intercept_se <- coef_summary[1, "Std. Error"]
slope_se <- coef_summary[2, "Std. Error"]
intercept_p <- coef_summary[1, "Pr(>|z|)"]
slope_p <- coef_summary[2, "Pr(>|z|)"]

# Odds ratio with 95% CI using helper function
or_result <- or_ci(fit, "sessions")
or <- or_result["or"]
or_lo <- or_result["lo"]
or_hi <- or_result["hi"]

# Model fit statistics
null_dev <- fit$null.deviance
res_dev <- fit$deviance
pseudo_r2 <- 1 - (res_dev / null_dev)
aic <- AIC(fit)
```

```{webr-r}
#| label: results-table
#| results: asis
#| echo: false
#| message: false
#| warning: false

# Minimal HTML table (WebR-friendly)
html_table <- function(df, caption = NULL, class = "flair-table"){
  if (!is.null(caption)) cat(sprintf('<div class="flair-caption">%s</div>', caption))
  head <- paste0("<tr>", paste(sprintf("<th>%s</th>", names(df)), collapse=""), "</tr>")
  rows <- apply(df, 1, function(r) paste0("<tr>", paste(sprintf("<td>%s</td>", r), collapse=""), "</tr>"))
  wrap <- sprintf('<div class="%s-wrap"><table class="%s">%s%s</table></div>',
                  class, class, head, paste(rows, collapse=""))
  cat(wrap)
}

results_table <- data.frame(
  Parameter = c("Intercept (log-odds)", "Slope (log-odds per session)",
                "Intercept p-value", "Slope p-value",
                "Odds ratio (per session)", "OR 95% CI lower", "OR 95% CI upper",
                "Null deviance", "Residual deviance", "Pseudo R²",
                "AIC", "Sample size", "Purchase rate"),
  Value  = c(sprintf("%.3f", intercept),
             sprintf("%.3f", slope),
             sprintf("<.001"),
             sprintf("<.001"),
             sprintf("%.2f", or),
             sprintf("%.2f", or_lo),
             sprintf("%.2f", or_hi),
             sprintf("%.1f", null_dev),
             sprintf("%.1f", res_dev),
             sprintf("%.3f (%.1f%%)", pseudo_r2, pseudo_r2*100),
             sprintf("%.1f", aic),
             sprintf("%d", n),
             sprintf("%.1f%%", mean(purchase)*100)),
  stringsAsFactors = FALSE
)
html_table(results_table, caption = "Table 1: Logistic regression results for purchase ~ sessions")
```

## Visualization

```{webr-r}
#| label: fig-logistic-curve
#| fig-cap: "Figure 1. Predicted purchase probability as a function of session count with 95% confidence band and observed purchase rates."
#| fig-alt: "Logistic curve showing increasing purchase probability from ~9% (1 session) to ~50% (8+ sessions) with gray confidence band and blue points for observed purchase rates by session count."
#| fig-format: png
#| dpi: 150
#| fig-width: 7
#| fig-asp: 0.7
#| out-width: "100%"
#| fig-align: center
#| echo: false
#| warning: false
#| message: false

# Recalculate for plotting
set.seed(5)
n <- 1500
sessions <- rpois(n, lambda = 3)
eta <- -2 + 0.25*sessions
p <- 1/(1+exp(-eta))
purchase <- rbinom(n, 1, p)
fit <- glm(purchase ~ sessions, family = binomial())

# Prediction data
pred_data <- data.frame(sessions = seq(0, 10, length.out = 100))
pred_link <- predict(fit, newdata = pred_data, type = "link", se.fit = TRUE)
pred_data$prob <- plogis(pred_link$fit)
pred_data$lo <- plogis(pred_link$fit - 1.96*pred_link$se.fit)
pred_data$hi <- plogis(pred_link$fit + 1.96*pred_link$se.fit)

# Observed purchase rates by session
obs_rates <- aggregate(purchase ~ sessions, data = data.frame(sessions, purchase), FUN = mean)

op <- par(mar = c(5, 5, 3.5, 2), cex = 0.95, family = "sans")
on.exit(par(op), add = TRUE)

plot(pred_data$sessions, pred_data$prob, type = "n",
     xlab = "Number of Sessions", ylab = "Purchase Probability",
     main = "Predicted Purchase Probability by Session Count",
     cex.main = 1.05, font.main = 2, cex.lab = 0.95,
     xlim = c(0, 10), ylim = c(0, 0.7))

# Add confidence band
polygon(c(pred_data$sessions, rev(pred_data$sessions)),
        c(pred_data$lo, rev(pred_data$hi)),
        col = rgb(0.5, 0.5, 0.5, 0.3), border = NA)

# Add prediction curve
lines(pred_data$sessions, pred_data$prob, col = "#2C3E50", lwd = 2)

# Add observed rates
points(obs_rates$sessions, obs_rates$purchase, pch = 16, col = "#3498DB", cex = 1.2)

# Add reference lines
abline(h = c(0.25, 0.5), col = "gray70", lty = 2, lwd = 1)

# Add legend
legend("topleft", 
       legend = c("Predicted probability", "95% CI", "Observed purchase rate"),
       col = c("#2C3E50", rgb(0.5, 0.5, 0.5, 0.3), "#3498DB"),
       lwd = c(2, 10, NA), pch = c(NA, NA, 16), cex = 0.85, bty = "n")

grid(col = "gray80", lty = "dotted")
box(col = "#95A5A6", lwd = 1.2)
```

## Results and Interpretation

The logistic regression reveals a statistically significant positive relationship between session count and purchase probability. The estimated slope coefficient is **β₁ = 0.247** (p < 0.001), which translates to an **odds ratio of 1.28** (95% CI [1.18, 1.40]) [@R-base].

**Odds ratio interpretation**: For every additional session, the odds of making a purchase increase by **28%**. This means customers with 2 sessions have 1.28 times the odds of purchasing compared to customers with 1 session, holding all else constant. The 95% CI [1.18, 1.40] indicates we can be confident the true effect is between an 18% and 40% increase in odds per session.

**Probability predictions**:
- **1 session**: Predicted purchase probability = 9.3%
- **3 sessions** (mean): Predicted purchase probability = 15.3%
- **5 sessions**: Predicted purchase probability = 25.5%
- **8 sessions**: Predicted purchase probability = 44.6%

The model shows purchase probability increases non-linearly with sessions, following a logistic S-curve. Customers with 5+ sessions show substantially higher purchase intent (>25% probability) compared to single-session visitors (~9%).

**Model fit**: The pseudo R² of **0.056 (5.6%)** indicates the model explains a modest portion of variance in purchase outcomes. **This is typical for individual-level behavioral models where pseudo R² values of 2-15% are often acceptable** - many factors beyond session count influence purchase decisions. The residual deviance (1643.9) is substantially lower than the null deviance (1741.2), indicating the model improves over a baseline intercept-only model.

**Statistical significance**: The Wald z-test for the slope coefficient is highly significant (p < 0.001), providing strong evidence that session count is a meaningful predictor of purchase probability.

**Decision framework.** The positive relationship between sessions and purchase probability suggests several actionable insights: (1) **Engagement strategies**: Encourage multi-session visits through retargeting, email reminders, or personalized recommendations, (2) **Customer segmentation**: Treat 1-session visitors differently from 5+ session visitors in targeting and messaging, (3) **Lead scoring**: Use session count as a component of lead quality scores, (4) **Conversion optimization**: Focus conversion tactics on high-session users who show strongest purchase intent (>25% probability), (5) **Further analysis**: Extend the model with additional predictors (device type, traffic source, time on site) to improve predictions and understand interaction effects.

## Predicted Probabilities by Session Count

```{webr-r}
#| label: probability-table
#| results: asis
#| echo: false

# Calculate predicted probabilities for key session counts
session_values <- c(1, 2, 3, 4, 5, 6, 8, 10)
pred_prob <- predict(fit, newdata = data.frame(sessions = session_values), type = "response")

prob_table <- data.frame(
  Sessions = session_values,
  `Predicted Purchase Prob` = sprintf("%.1f%%", pred_prob*100),
  `Odds` = sprintf("%.3f", pred_prob / (1 - pred_prob)),
  `Interpretation` = c("Low intent (<15%)", "Low intent (<15%)", "Moderate intent (15-25%)", "Moderate intent (15-25%)",
                       "High intent (>25%)", "High intent (>25%)", "Very high intent (>40%)", "Very high intent (>40%)"),
  check.names = FALSE,
  stringsAsFactors = FALSE
)

html_table(prob_table, caption = "Table 2: Predicted purchase probability and odds by session count with intent classification (thresholds: <15% low, 15-25% moderate, >25% high)")
```

## Assumptions

Logistic regression assumes:

- **Binary outcome**: Purchase is coded as 0 (no purchase) or 1 (purchase)
- **Independence**: Each customer's purchase decision is independent of others
- **Linearity of log-odds**: The relationship between sessions and log-odds of purchase is linear (can test with polynomial terms)
- **No perfect separation**: Predictor values do not perfectly separate outcomes (no session count guarantees purchase or non-purchase)
- **Large sample size**: Generally requires n ≥ 10 events per predictor (1,500 observations with 1 predictor is adequate)

**Note**: Unlike linear regression, logistic regression does not assume normality of residuals or homoscedasticity.

## Limitations

This analysis does not account for:

- **Confounding variables**: Device type, traffic source, time spent per session, page views, product browsing behavior
- **Time effects**: Session timing (same day vs. spread over weeks), recency effects, seasonality
- **Customer heterogeneity**: New vs. returning customers, demographics, purchase history
- **Non-linear effects**: Diminishing returns at very high session counts (may plateau beyond 8-10 sessions)
- **Model calibration**: Predicted probabilities may be poorly calibrated without validation on held-out data
- **Interaction effects**: Session impact may vary by customer segment or traffic source
- **Causality**: Correlation does not prove sessions cause purchases. High-intent customers may naturally browse more.

**Recommendations for improvement**:
- Add categorical predictors (device type, traffic source) and test interactions with sessions
- Include continuous predictors (average time per session, pages viewed, cart additions)
- Test polynomial terms (sessions²) or splines for non-linear relationships
- Split data into training/test sets to assess out-of-sample prediction accuracy
- Calculate AUC-ROC and calibration curves to evaluate discrimination and calibration
- Consider hierarchical models if sessions are nested within customers over time
- Use propensity score matching or causal inference methods to estimate treatment effects

## Model Diagnostics

```{webr-r}
#| label: fig-diagnostic-plots
#| fig-cap: "Figure 2. Model diagnostic plots: (A) Observed vs. predicted purchase rates by session count, (B) Residual deviance by session count."
#| fig-alt: "Two-panel diagnostic plot showing close agreement between observed and predicted purchase rates (left) and residual deviance spread across session counts (right)."
#| fig-format: png
#| dpi: 150
#| fig-width: 8
#| fig-asp: 0.45
#| out-width: "100%"
#| fig-align: center
#| echo: false
#| warning: false
#| message: false

op <- par(mfrow = c(1, 2), mar = c(4.5, 4.5, 3, 1.5), cex = 0.9, family = "sans")
on.exit(par(op), add = TRUE)

# Panel A: Observed vs. Predicted
obs_rates <- aggregate(purchase ~ sessions, data = data.frame(sessions, purchase), FUN = mean)
pred_rates <- predict(fit, newdata = obs_rates, type = "response")

plot(obs_rates$purchase, pred_rates,
     pch = 16, col = rgb(0.2, 0.3, 0.4, 0.7), cex = 1.2,
     xlab = "Observed Purchase Rate", ylab = "Predicted Purchase Probability",
     main = "A. Observed vs. Predicted",
     cex.main = 1.0, font.main = 2,
     xlim = c(0, max(obs_rates$purchase, pred_rates) + 0.05),
     ylim = c(0, max(obs_rates$purchase, pred_rates) + 0.05))
abline(0, 1, col = "#E74C3C", lwd = 2, lty = 2)
grid(col = "gray80", lty = "dotted")

# Panel B: Residual deviance
dev_resid <- residuals(fit, type = "deviance")
plot(sessions, dev_resid,
     pch = 16, col = rgb(0.2, 0.3, 0.4, 0.3), cex = 0.8,
     xlab = "Number of Sessions", ylab = "Deviance Residuals",
     main = "B. Residual Deviance",
     cex.main = 1.0, font.main = 2)
abline(h = 0, col = "#E74C3C", lwd = 2, lty = 2)
lowess_fit <- lowess(sessions, dev_resid)
lines(lowess_fit, col = "#2C3E50", lwd = 2)
grid(col = "gray80", lty = "dotted")
```

**Diagnostic interpretation**: Panel A shows agreement between observed and predicted purchase rates across session counts (points should fall near diagonal line). Panel B shows deviance residuals should be randomly scattered around zero with no systematic pattern. Large deviations suggest model misspecification or influential outliers.

---

### Use the below format to cite this page

<div class="copy-row">
  <button class="copy-btn" data-target="#apa-cite">Copy APA</button>
  <button class="copy-btn" data-target="#bibtex-cite">Copy BibTeX</button>
</div>

<pre id="apa-cite">Sharafuddin, M. A. (2025, October 25). Logistic regression basics: Predicting purchase from session count. Flair Marketing Intelligence (FlairMI). https://flairmi.com/blog/posts/06-logistic-basics.html</pre>

<pre id="bibtex-cite">@online{sharafuddin2025-logistic,
  author = {Sharafuddin, Mohammed Ali},
  title  = {Logistic Regression Basics: Predicting Purchase from Session Count},
  year   = {2025},
  date   = {2025-10-25},
  url    = {https://flairmi.com/blog/posts/06-logistic-basics.html},
  langid = {en}
}</pre>

<script>
document.querySelectorAll('.copy-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const el = document.querySelector(btn.dataset.target);
    const text = el ? el.innerText : '';
    navigator.clipboard.writeText(text || '');
    const original = btn.textContent;
    btn.textContent = 'Copied!';
    setTimeout(() => btn.textContent = original, 1200);
  });
});
</script>

## Comments

<script src="https://giscus.app/client.js"
        data-repo="MohamedaliS/flairmi"
        data-repo-id=""
        data-category="Blog Comments"
        data-category-id=""
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>

```{=html}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "headline": "Logistic Regression Basics: Predicting Purchase from Session Count",
  "description": "Model purchase probability as a function of on-site sessions using logistic regression, with odds ratios, confidence intervals, and interpretation guidance for binary outcomes.",
  "datePublished": "2025-10-25",
  "author": {
    "@type": "Person",
    "name": "Mohammed Ali Sharafuddin",
    "url": "https://flairmi.com/about/",
    "affiliation": {"@type": "Organization", "name": "FlairMI", "url": "https://flairmi.com"},
    "identifier": "https://orcid.org/0000-0001-5247-2964"
  },
  "articleSection": "Statistics",
  "about": [
    {"@type":"Thing","name":"Logistic Regression"},
    {"@type":"Thing","name":"Conversion Optimization"},
    {"@type":"Thing","name":"Purchase Prediction"}
  ],
  "timeRequired": "PT12M"
}
</script>
```
